import{F as k,t as F,r as m,w as s,S as B,H as I,B as $,K as b,Q as _,M as A,P as D}from"./index-686e0b19.js";import{U as L}from"./LoadingRefresh-b9dcae7d.js";import{U}from"./UniversalBody-ff1f50f0.js";import{S as E}from"./react-select.esm-d701797a.js";import{p as N}from"./ImageCompressor-ef630e5a.js";import"./index-5848e3fb.js";const P={control:(u,o)=>({...u,borderColor:(o.isFocused||o.isSelected,"#08a284"),boxShadow:"none","&:hover":{borderColor:"#08a284"}}),placeholder:u=>({...u,color:"#000"})};function R(){var c,r,S,y,C;const{posts:u,topBanner:o}=k(t=>t.home),d=F(),[l,f]=m.useState({news:(c=o==null?void 0:o.news)==null?void 0:c._id,status:o==null?void 0:o.status}),[g,p]=m.useState(u.filter(t=>t._id==l.news)),[w,h]=m.useState(!1),[x,j]=m.useState({status:"",message:"",type:""}),[a,e]=m.useState({label:(r=o==null?void 0:o.news)==null?void 0:r.title,value:l.news}),n=t=>{t?(p(u.filter(v=>v._id==t.value)),e(t),f({...l,news:t.value})):(f(""),p(""),e(""))},i=()=>{d(b(!0)),_(`/topbanner/${o._id}`,l).then(t=>{var v;d(b(!1)),t.success?(console.log(t),j({status:"",message:t==null?void 0:t.message,type:"success"}),h(!0)):(j({status:`Error Code ${t==null?void 0:t.status}`,message:(v=t==null?void 0:t.data)==null?void 0:v.message,type:"error"}),h(!0)),setTimeout(()=>{h(!1)},3e3)})};return s.jsxs(s.Fragment,{children:[w&&s.jsx(B,{direction:"vertical",style:{minWidth:"25%",position:"fixed",zIndex:"1",left:"50%",transform:"translateX(-40%)",top:"1%"},children:s.jsx(I,{message:`${x.status}`,description:`${x.message}`,type:x.type,showIcon:!0,closable:!0,onClose:()=>{h(!1)}})}),s.jsxs("div",{className:"banner_content",children:[s.jsxs("form",{action:"",children:[s.jsx("label",{htmlFor:"",children:"Main Banner"}),s.jsx(E,{options:u.map(t=>({value:t==null?void 0:t._id,label:t.title})),value:a,onChange:n,styles:P})]}),s.jsxs("div",{className:"banner_img_div",children:[s.jsx("h1",{children:a.label?a.label:"Tanlang"}),s.jsx("div",{children:s.jsx("img",{src:(S=g[0])!=null&&S.image?$+((C=(y=g[0])==null?void 0:y.image)==null?void 0:C.name):"https://www.designtak.se/doesnotexist.png"})})]}),s.jsxs("div",{className:"checkbox-wrapper-47",children:[s.jsx("input",{type:"checkbox",name:"cb",id:"cb-47",checked:l.status,onChange:()=>{f({...l,status:!l.status})}}),s.jsxs("label",{htmlFor:"cb-47",children:[l.status?"Active qilindi":"Active qilish"," "]})]}),s.jsx("button",{onClick:t=>{t.preventDefault(),i()},children:"Publish"})]})]})}function T(){const{bannerData:u}=k(a=>a.home),o=F(),[d,l]=m.useState(Array.isArray(u)?u.map(a=>{var e;return{...a,image:(e=a==null?void 0:a.image)==null?void 0:e._id,imgUrl:"",imgData:null}}):[]),[f,g]=m.useState(!1),[p,w]=m.useState({status:"",message:""}),h=m.useRef(),x=async a=>{var n;o(b(!0));const e=d[a];if(e.imgUrl){(n=e==null?void 0:e.image)!=null&&n._id&&await A(`/image/${e.image._id}`);const i=await D("/image/upload",e.imgData),c={...e,image:i.data._id},r=await _(`/banner/${e._id}`,c);j(!1,r!=null&&r.success?"success":"error",r)}else{const i=await _(`/banner/${e._id}`,e);j(!1,i!=null&&i.success?"success":"error",i)}},j=(a,e,n)=>{var c;o(b(a));const i=e==="success"?"":`Error Code ${n==null?void 0:n.status}`;w({status:i,message:n!=null&&n.success?n==null?void 0:n.message:(c=n==null?void 0:n.data)==null?void 0:c.message,type:e}),g(!0),setTimeout(()=>{g(!1)},3e3)};return s.jsxs(s.Fragment,{children:[f&&s.jsx(B,{direction:"vertical",style:{minWidth:"25%",position:"fixed",zIndex:"0",left:"50%",transform:"translateX(-40%)",top:"1%"},children:s.jsx(I,{message:`${p.status}`,description:`${p.message}`,type:p.type,showIcon:!0,closable:!0,onClose:()=>{g(!1)}})}),s.jsx("div",{className:"banner_content",children:d.map((a,e)=>{var n;return s.jsxs("form",{action:"",children:[s.jsxs("label",{htmlFor:"",children:["Footer Banner ",e+1]}),s.jsx("input",{placeholder:"Paste Link",type:"text",value:a.link,onChange:i=>{const c=[...d];c[e].link=i.target.value,l(c)}}),s.jsx("div",{className:"changePhotoBtn",children:s.jsx("button",{onClick:()=>{h.current.click()},children:"Change Photo"})}),s.jsxs("div",{className:"form_div",children:[s.jsx("input",{ref:h,className:"input_img",type:"file",accept:"image/*",onChange:i=>{N(i,c=>{const r=[...d];r[e].imgUrl=c,l(r)},c=>{const r=[...d];r[e].imgData=c,l(r)})}}),a.imgUrl||(n=a==null?void 0:a.image)!=null&&n.name?s.jsx("label",{children:s.jsx("img",{src:a.imgUrl?a.imgUrl:$+a.image.name,alt:"Banner"})}):null]}),s.jsxs("div",{className:"checkbox-wrapper-48",children:[s.jsx("input",{type:"checkbox",name:"cb",id:`cb-${e}`,checked:a.status,onChange:()=>{const i=[...d];i[e].status=!i[e].status,l(i)}}),s.jsx("label",{htmlFor:`cb-${e}`,children:a.status?"Active qilindi":"Active qilish"})]}),s.jsx("button",{onClick:i=>{i.preventDefault(),x(e)},children:"Publish"})]},a._id)})})]})}const M={title:"Banner",btn:""};function K(){return s.jsxs("div",{className:"banner_section",children:[s.jsx(L,{data:M}),s.jsx(U,{children:s.jsxs("div",{className:"banner_body",children:[s.jsx(R,{}),s.jsx(T,{})]})})]})}export{K as default};
