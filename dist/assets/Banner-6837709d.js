import{F as I,t as k,r as l,w as e,S as F,H as $,B as A,K as w,Q as C,M as E,P as N}from"./index-1dc67d24.js";import{U as B}from"./LoadingRefresh-873d05e2.js";import{U}from"./UniversalBody-2822899b.js";import{S as P}from"./react-select.esm-3a8e5b03.js";import{p as R}from"./ImageCompressor-ef630e5a.js";import"./index-082b27f3.js";const T={control:(t,n)=>({...t,borderColor:(n.isFocused||n.isSelected,"#08a284"),boxShadow:"none","&:hover":{borderColor:"#08a284"}}),placeholder:t=>({...t,color:"#000"})};function L(){var j,b,o,c,a;const{posts:t,topBanner:n}=I(s=>s.home),v=k(),[r,i]=l.useState({news:(j=n==null?void 0:n.news)==null?void 0:j._id,status:n==null?void 0:n.status}),[h,y]=l.useState(t.filter(s=>s._id==r.news)),[g,d]=l.useState(!1),[p,u]=l.useState({status:"",message:"",type:""}),[x,f]=l.useState({label:(b=n==null?void 0:n.news)==null?void 0:b.title,value:r.news}),_=s=>{s?(y(t.filter(m=>m._id==s.value)),f(s),i({...r,news:s.value})):(i(""),y(""),f(""))},S=()=>{v(w(!0)),C(`/topbanner/${n._id}`,r).then(s=>{var m;v(w(!1)),s.success?(console.log(s),u({status:"",message:s==null?void 0:s.message,type:"success"}),d(!0)):(u({status:`Error Code ${s==null?void 0:s.status}`,message:(m=s==null?void 0:s.data)==null?void 0:m.message,type:"error"}),d(!0)),setTimeout(()=>{d(!1)},3e3)})};return e.jsxs(e.Fragment,{children:[g&&e.jsx(F,{direction:"vertical",style:{minWidth:"25%",position:"fixed",zIndex:"1",left:"50%",transform:"translateX(-40%)",top:"1%"},children:e.jsx($,{message:`${p.status}`,description:`${p.message}`,type:p.type,showIcon:!0,closable:!0,onClose:()=>{d(!1)}})}),e.jsxs("div",{className:"banner_content",children:[e.jsxs("form",{action:"",children:[e.jsx("label",{htmlFor:"",children:"Main Banner"}),e.jsx(P,{options:t.map(s=>({value:s==null?void 0:s._id,label:s.title})),value:x,onChange:_,styles:T})]}),e.jsxs("div",{className:"banner_img_div",children:[e.jsx("h1",{children:x.label?x.label:"Tanlang"}),e.jsx("div",{children:e.jsx("img",{src:(o=h[0])!=null&&o.image?A+((a=(c=h[0])==null?void 0:c.image)==null?void 0:a.name):"https://www.designtak.se/doesnotexist.png"})})]}),e.jsxs("div",{className:"checkbox-wrapper-47",children:[e.jsx("input",{type:"checkbox",name:"cb",id:"cb-47",checked:r.status,onChange:()=>{i({...r,status:!r.status})}}),e.jsxs("label",{htmlFor:"cb-47",children:[r.status?"Active qilindi":"Active qilish"," "]})]}),e.jsx("button",{onClick:s=>{s.preventDefault(),S()},children:"Publish"})]})]})}function M(){var j,b;const{bannerData:t}=I(o=>o.home),n=k(),[v,r]=l.useState(),[i,h]=l.useState({...t,image:(j=t==null?void 0:t.image)==null?void 0:j._id}),[y,g]=l.useState(!1),[d,p]=l.useState({status:"",message:""}),[u,x]=l.useState(""),f=l.useRef(),_=async()=>{var o;if(n(w(!0)),u){(o=t==null?void 0:t.image)!=null&&o._id&&await E(`/image/${t.image._id}`);const c=await N("/image/upload",v),a={...i,image:c.data._id},s=await C(`/banner/${t._id}`,a);S(!1,s!=null&&s.success?"success":"error",s)}else{const c=await C(`/banner/${t._id}`,i);S(!1,c!=null&&c.success?"success":"error",c)}},S=(o,c,a)=>{var m;n(w(o));const s=c==="success"?"":`Error Code ${a==null?void 0:a.status}`;p({status:s,message:a!=null&&a.success?a==null?void 0:a.message:(m=a==null?void 0:a.data)==null?void 0:m.message,type:c}),g(!0),setTimeout(()=>{g(!1)},3e3)};return e.jsxs(e.Fragment,{children:[y&&e.jsx(F,{direction:"vertical",style:{minWidth:"25%",position:"fixed",zIndex:"0",left:"50%",transform:"translateX(-40%)",top:"1%"},children:e.jsx($,{message:`${d.status}`,description:`${d.message}`,type:d.type,showIcon:!0,closable:!0,onClose:()=>{g(!1)}})}),e.jsxs("div",{className:"banner_content",children:[e.jsxs("form",{action:"",children:[e.jsx("label",{htmlFor:"",children:"Footer Banner"}),e.jsx("input",{placeholder:"Paste Link",type:"text",value:i.link,onChange:o=>{h({...i,link:o.target.value})}})]}),e.jsx("div",{className:"changePhotoBtn",children:e.jsx("button",{onClick:()=>{f.current.click()},children:"Change Photo"})}),e.jsxs("div",{className:"form_div",children:[e.jsx("input",{ref:f,className:"input_img",type:"file",accept:"image/*",onChange:o=>{R(o,x,r)}}),e.jsx("label",{children:(u||((b=t==null?void 0:t.image)==null?void 0:b.name))&&e.jsx("img",{src:u||A+t.image.name})})]}),e.jsxs("div",{className:"checkbox-wrapper-48",children:[e.jsx("input",{type:"checkbox",name:"cb",id:"cb-48",checked:i.status,onChange:()=>{h({...i,status:!i.status})}}),e.jsxs("label",{htmlFor:"cb-48",children:[i.status?"Active qilindi":"Active qilish"," "]})]}),e.jsx("button",{onClick:o=>{o.preventDefault(),_()},children:"Publish"})]})]})}const q={title:"Banner",btn:""};function K(){return e.jsxs("div",{className:"banner_section",children:[e.jsx(B,{data:q}),e.jsx(U,{children:e.jsxs("div",{className:"banner_body",children:[e.jsx(L,{}),e.jsx(M,{})]})})]})}export{K as default};
